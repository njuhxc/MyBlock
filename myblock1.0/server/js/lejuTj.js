/***2017-10-10 23:49:55***/!function(){function t(){var t,i=o.get("gatheruuid");""!=i&&n(i)||(i=e(),t=new Image,t.onload=null,t.src="http://tongji.leju.com/api/ck/set_ck.json?guid="+i,t.style.display="none"),o.save("gatheruuid",i,180)}function e(){var t,e="0123456789abcdefghijklmnopqrstuvwxyz",n=(new Date).getTime()+"",o=0;for(t=0;3>t;t++)o=Math.floor(Math.random()*(13+t)),n=n.substr(0,o)+e.substr(Math.floor(36*Math.random()),1)+n.substr(o);return n}function n(t){var e=/^[0-9a-zA-Z]{16}$/;return e.test(t)}var o={db:document.cookie,host:document.location.host,getCookieRootDomain:function(){function t(t){var e,n=document.cookie,o=n.indexOf(t+"=");return-1==o||o&&!~n.indexOf("; "+t+"=")?"":(o=o+t.length+1,e=n.indexOf("; ",o),-1==e&&(e=n.length),decodeURIComponent(n.substring(o,e)))}var e,n,o=location.host.split(":").shift().split("."),i=o.length;if(1==i)return rootDomain="";for(e="TMP"+ +new Date;i-- >2&&(n=o.slice(1).join("."),document.cookie=e+"="+e+"; domain="+n,e=t(e),document.cookie=e+"=1; expires=Thu, 01 Jan 1970 00:00:00 GMT; domain="+n,e);)o.shift();return rootDomain=o.join(".")},getDomain:function(){return this.getCookieRootDomain()},save:function(t,e,n){var o=new Date,i=this.getDomain();o.setDate(o.getDate()+n),document.cookie=t+"="+encodeURI(e)+(null==n?"":";expires="+o.toGMTString())+";path=/;"+(""==i?"":"domain="+i)},get:function(t){var e,n;return document.cookie.length>0&&(e=document.cookie.indexOf(t+"="),-1!=e)?(e=e+t.length+1,n=document.cookie.indexOf(";",e),-1==n&&(n=document.cookie.length),decodeURI(document.cookie.substring(e,n))):""}};t()}(),!function(){function LejuTj(t){this.items=[],this.protocol=window.location.protocol,this.opt={position:"body",sendUrl:this.protocol+"//tongji.leju.com/h.gif",pvSendUrl:this.protocol+"//tongji.leju.com/g.gif",eventUrl:this.protocol+"//tongji.leju.com/e.gif",limitUrl:["http://m.leju.com/touch/index/","http://m.bch.leju.com/touch/index/"],pvLimitHost:["all"],eventLimitHost:["all"],tjType:{pv:1},statisticsItem:["a","button","body","i"],tid:"",uuid:"",heatmap:!0,pvTj:!0,maxLength:4,localCookieName:"local_lejutj_params"},this.submitUrl="",this.arrImg=[],this.taskQueue=[],this.gatheruuid="",this.newgatheruuid="";for(var e in t)t.hasOwnProperty(e)&&void 0!==t[e]&&(this.opt[e]=t[e]);this.init()}function checkEventParams(t,e){return"string"!=typeof t||""===t.replace(/(^\s*)|(\s*$)/g,"")?(console.error("请以字符串形式传入事件名称！"),!1):"object"!=typeof e?(console.error("请以对象形式传入参数！"),!1):!0}function sendLocalEventData(){var t,e=this,n=COOKIE_UTILS.get(e.opt.localCookieName);if(""!==n)try{t=JSON.parse(n).shift(),t&&(sendImgData(e,t.submitUrl+"?"+getParamUrl(t)),COOKIE_UTILS.save(e.opt.localCookieName,"",-1))}catch(o){console.error(o.message)}}function sendImgData(t,e){function n(t,e){return function(){return e.apply(t,arguments)}}var o,i,r,a=t.arrImg,s=a.length,u=-1;for(o=0;s>o;o++)if(0==a[o].f){u=o;break}if(-1==u){if(s==t.opt.maxLength)return void t.taskQueue.push(e);img=new Image,a.push({f:1,img:img}),u=0==s?0:s}else img=a[u].img;a[u].f=1,img.setAttribute("data-vid",u),i=function(){var e=this.getAttribute("data-vid");e>=0&&(a[e].f=0),t.taskQueue.length>0&&sendImgData(t,t.taskQueue.shift())},r=n(img,i),EventUtil.removeHandler(img,"load",r),EventUtil.removeHandler(img,"error",r),EventUtil.addHandler(img,"load",r),EventUtil.addHandler(img,"error",r),img.src=e}function urlFilter(t){var e,n,o,i;if("heat"===t?(e=location.href.split("?")[0],n=this.opt.limitUrl):"pv"===t?(e=location.host,n=this.opt.pvLimitHost):"event"===t&&(e=location.host,n=this.opt.eventLimitHost),1===n.length&&"all"===n[0])return!0;for(o=0,i=n.length;i>o;o++)if(e===n[o])return!0;return!1}function prepareParams(){var t,e,n,o=[],i=this.items,r=i[i.length-1],a={};switch(r[0]){case"_heatEvent":this.sendProxy("heat")&&o.push({submitUrl:this.opt.sendUrl,guid:this.gatheruuid,x:r[3],y:r[4],width:r[5],height:r[6],refer_url:r[7],url:r[8],uuid:r[9],date:(new Date).getTime()});break;case"_pvEvent":this.sendProxy("pv")&&(a.t=this.opt.tjType.pv,a.submitUrl=this.opt.pvSendUrl,setCommonParams.call(this,a),setFromUrlParams.call(this,a),o.push(a));break;case"_cEvent":if(this.sendProxy("event")){t=r[1],e=r[2];for(n in e)e.hasOwnProperty(n)&&(a["c_"+n]="object"==typeof e[n]?JSON.stringify(e[n]):"function"==typeof e[n]?e[n].toString():e[n]);a.submitUrl=this.opt.eventUrl,a.ename=t,setCommonParams.call(this,a),setFromUrlParams.call(this,a),o.push(a)}}return o}function setCommonParams(t){t.nt=commonParams.getNowtime(),t.ru=commonParams.getReferrer(),t.u=commonParams.getHref(),t.uuid=this.opt.uuid,t.guid=this.gatheruuid,t.tt=commonParams.getTitle(),t.ds=commonParams.getScreenSize(),t.source=commonParams.getSource()}function setFromUrlParams(t){var e,n,o,i,r=window.location.href.split("#");if(r[1])for(e=r[1].split("&"),n=0,o=e.length;o>n;n++)i=e[n].split("="),i[1]&&(t["url_"+i[0]]=i[1])}function bindHeatMapEvent(){function t(t){var e=EventUtil.getEvent(t);if(o={startX:0,startY:0,endX:0,endY:0,endPageX:0,endPageY:0},isMobile){if("undefined"==typeof e.changedTouches)return;e=e.changedTouches[0]}o.startX=e.clientX||0,o.startY=e.clientY||0}function e(t){var e,n=EventUtil.getEvent(t);if(isMobile){if("undefined"==typeof n.changedTouches)return;n=n.changedTouches[0]}o.endX=n.clientX||0,o.endY=n.clientY||0,o.endPageX=n.pageX||0,o.endPageY=n.pageY||0,i=n.srcElement||n.target,isTap(o)&&(e=new Date,canPush.call(r,e.getTime(),o.endPageX,o.endPageY)&&r.push(["_heatEvent",e.getTime(),i.nodeName,o.endPageX,o.endPageY,document.body.scrollWidth,document.body.scrollHeight,document.referrer,location.href,r.opt.uuid]))}var n=$(this.opt.position),o={},i="",r=this;n.length>0?isMobile?(EventUtil.addHandler(n[0],"touchstart",t),EventUtil.addHandler(n[0],"touchend",e)):(EventUtil.addHandler(n[0],"mousedown",t),EventUtil.addHandler(n[0],"mouseup",e)):console.error("position is undefined.")}function bindPageStatistics(){function clickHandler(event){for(var paramsName,paramsStr,params,e=EventUtil.getEvent(event),target=EventUtil.getTarget(e);target&&target.tagName&&!arrayContain(target.tagName.toLowerCase(),that.opt.statisticsItem);)target=target.parentNode;return target?(paramsName=target.getAttribute("data-lejutj-event-name"),paramsStr=target.getAttribute("data-lejutj-event-params"),void(paramsName&&paramsStr&&""!==paramsName&&""!==paramsStr&&(params=eval("("+paramsStr+")"),"object"==typeof params?that.event(paramsName,params):console.error("data-lejutj-event-params 参数错误")))):!1}var $body=$("body"),that=this;$body.length>0?EventUtil.addHandler($body[0],"click",clickHandler):console.error("position is undefined.")}function arrayContain(t,e){for(var n=0,o=e.length;o>n;n++)if(t===e[n])return!0;return!1}function isTap(t){var e=t.endX-t.startX,n=t.endY-t.startY;return Math.pow(e*e+n*n,.5)<=THRESHOLD}function canPush(t,e,n){return!(this.items.length>0&&e>this.items[0][3]-FILTER_DIS&&e<this.items[0][3]+FILTER_DIS&&n>this.items[0][4]-FILTER_DIS&&n<this.items[0][4]+FILTER_DIS&&this.items[0][1]+FILTER_TIME>=t)}function getParamUrl(t){var e,n="",o=!1,i="";for(e in t)t.hasOwnProperty(e)&&"submitUrl"!==e&&("ru"===e?(o=!0,i=encodeURIComponent(t[e])):n+=e+"="+encodeURIComponent(t[e])+"&");return o?n+"ru="+i:n.substr(0,n.length-1)}function getQueryString(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!=n?decodeURIComponent(n[2]):""}function getUrlHash(t){var e,n,o,i,r,a,s=window.location.hash;if(""!=s)for(e=s.substring(s.indexOf("#")+1).split("&"),n=0,o=e.length;o>n;n++)if(""!=e[n])for(i=e[n].split("="),r=0,a=i.length;a>r;r++)if(i[0]==t)return i[1];return""}function pvEvent(){this.push(["_pvEvent"])}function getRootDomain(t){var e,n,o;if(!t)return"";if(-1!=t.indexOf("://")&&(t=t.substr(t.indexOf("://")+3)),-1!=t.indexOf("/")&&(t=t.substr(0,t.indexOf("/"))),-1!=t.indexOf("?")&&(t=t.substr(0,t.indexOf("?"))),e=["com","net","org","gov","edu","mil","biz","name","info","mobi","pro","travel","museum","int","areo","post","rec"],n=t.split("."),n.length<=1)return t;if(!isNaN(n[n.length-1]))return t;for(o=0;o<e.length&&e[o]!=n[n.length-1];)o++;if(o!=e.length)return n[n.length-2]+"."+n[n.length-1];for(o=0;o<e.length&&e[o]!=n[n.length-2];)o++;return o==e.length?n[n.length-2]+"."+n[n.length-1]:n[n.length-3]+"."+n[n.length-2]+"."+n[n.length-1]}function initId(){this.opt.uuid=COOKIE_UTILS.get("M_UID"),this.gatheruuid=COOKIE_UTILS.get("gatheruuid")}var idSelectorRE=/^#([\w-]*)$/,tagSelectorRE=/^[\w-]+$/,$=function(t){var e;return idSelectorRE.test(t)?(e=document.getElementById(RegExp.$1))?[e]:[]:tagSelectorRE.test(t)?document.getElementsByTagName(t):[]},isMobile=function(){var t=navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),n="iphone os"==t.match(/iphone os/i),o="midp"==t.match(/midp/i),i="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),r="ucweb"==t.match(/ucweb/i),a="android"==t.match(/android/i),s="windows ce"==t.match(/windows ce/i),u="windows mobile"==t.match(/windows mobile/i);return!!(e||n||o||i||r||a||s||u)}(),THRESHOLD=5,FILTER_DIS=5,FILTER_TIME=5e3,COOKIE_UTILS={db:document.cookie,host:document.location.host,getCookieRootDomain:function(){function t(t){var e,n=document.cookie,o=n.indexOf(t+"=");return-1==o||o&&!~n.indexOf("; "+t+"=")?"":(o=o+t.length+1,e=n.indexOf("; ",o),-1==e&&(e=n.length),decodeURIComponent(n.substring(o,e)))}var e,n,o=location.host.split(":").shift().split("."),i=o.length;if(1==i)return rootDomain="";for(e="TMP"+ +new Date;i-- >2&&(n=o.slice(1).join("."),document.cookie=e+"="+e+"; domain="+n,e=t(e),document.cookie=e+"=1; expires=Thu, 01 Jan 1970 00:00:00 GMT; domain="+n,e);)o.shift();return rootDomain=o.join(".")},getDomain:function(){return this.getCookieRootDomain()},save:function(t,e,n){var o=new Date,i=this.getDomain();o.setDate(o.getDate()+n),document.cookie=t+"="+encodeURI(e)+(null==n?"":";expires="+o.toGMTString())+";path=/;"+(""==i?"":"domain="+i)},get:function(t){var e,n;return document.cookie.length>0&&(e=document.cookie.indexOf(t+"="),-1!=e)?(e=e+t.length+1,n=document.cookie.indexOf(";",e),-1==n&&(n=document.cookie.length),decodeURI(document.cookie.substring(e,n))):""}},EventUtil={addHandler:function(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n},removeHandler:function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null},getTarget:function(t){return t.target||t.srcElement},getEvent:function(t){return t||window.event}},commonParams={getNowtime:function(){var t=new Date;return t.getTime()},getReferrer:function(){return document.referrer},getHref:function(){return window.location.href},getTitle:function(){return document.title},getScreenSize:function(){return window.screen.width+"x"+window.screen.height},getSource:function(){var t,e=getQueryString("ljmf_source");return""==e&&(e=getUrlHash("ljmf_source")),t=getQueryString("source"),""==t&&(t=getUrlHash("source")),""!=e?(COOKIE_UTILS.save("source_name",e,1),e):""!=t?(COOKIE_UTILS.save("source_name",t,1),t):COOKIE_UTILS.get("source_name")}};LejuTj.prototype.push=function(t){this.items.push(t),this.sendData()},LejuTj.prototype.init=function(){initId.call(this),this.opt.pvTj&&pvEvent.apply(this),this.opt.heatmap&&bindHeatMapEvent.apply(this),bindPageStatistics.apply(this),sendLocalEventData.apply(this),this.isDomainChanged()},LejuTj.prototype.sendProxy=function(t){return urlFilter.call(this,t)},LejuTj.prototype.sendPv=function(){this.opt.pvTj&&pvEvent.apply(this)},LejuTj.prototype.sendData=function(){var t,e=prepareParams.call(this),n=e.shift();void 0!==n&&(t=n.submitUrl+"?"+getParamUrl(n),sendImgData(this,t)),this.items.length>1&&this.items.shift()},LejuTj.prototype.event=function(t,e){checkEventParams(t,e)&&this.push(["_cEvent",t,e])},LejuTj.prototype.localEvent=function(t,e){if(checkEventParams(t,e)){this.items.push(["_cEvent",t,e]);var n=prepareParams.call(this);COOKIE_UTILS.save(this.opt.localCookieName,JSON.stringify(n),180)}},LejuTj.prototype.isDomainChanged=function(){var t=getRootDomain(commonParams.getReferrer()),e=COOKIE_UTILS.getCookieRootDomain();return""!==t&&e!==t?(COOKIE_UTILS.save("refer_domain",t,180),!0):!1},window.lejuTj||(window.lejuTj=new LejuTj)}();