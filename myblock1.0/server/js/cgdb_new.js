define("sjs/matrix/ad/form/cgdb_new",["sjs/matrix/ad/form/commonspe","sjs/data/cookie","sjs/data/json","sjs/matrix/ad/special","sjs/matrix/ad/statspe","sjs/base/corespe"],function(Common,cookie,JSON,special,stat,corespe){var $=jQuery;var setTimeout=window.setTimeout;var clearTimeout=window.clearTimeout;var sohuad_bottom_time=0;var sohuad_bottom_replay=0;var report=0;var report_small=0;var report_big=0;var reported_small=false;var isReplayed=false;if(window.innerWidth)winWidth=document.body.clientWidth;else if((document.body)&&(document.body.clientWidth))winWidth=document.body.clientWidth;var Cgdb=Common.create({options:{width:1180,zIndex:999,timeout:8000,adobj:null,timelimit:4},init:function(){var self=this;var adObj=this.adObject;var is360=self._mime("type","application/vnd.chromium.remoting-viewer");if(!!adObj[adObj.special.dict.third]&&!!adObj[adObj.special.dict.third].text){var thirdsource=adObj[adObj.special.dict.third];this.loadThirdCode(thirdsource.text,adObj)}else{if(jQuery("#SohuBottomWrapper").length!=0||jQuery("#SohuBottomWrapper2").length!=0){return}this.sohuad_buttom_n();this.attach();if(!this.check()){sohuad_bottom_replay=1;this.sohuad_buttom_b()}else{reported_small=true;this.sohuad_buttom_s()}jQuery("#hover_over").bind("click",function(event){event.stopPropagation();self.adObject.cx=event.clientX;self.adObject.cy=event.clientY;stat.get("click",adObj);self.postAdplus(self.adObject)});if(self.isChrome()&&is360){jQuery("#SohuBottom2_f").css({"background-color":"rgba(0,0,0,0.8)"});jQuery("#SohuBottom_f").css({"background-color":"rgba(0,0,0,0.8)"})}this.addMonitorkey();adObj.trigger("afterload");stat.get("av",adObj)}},sohuad_buttom_b:function(){var self=this;var adObj=this.adObject;var resource=adObj.resource;var opt=this.options;jQuery('#SohuBottomWrapper').hide();jQuery('#SohuBottomWrapper2').show();if(adObj.resource.type=="flash"){if(corespe.sflash()==0){var cgdb_big_pic=adObj[adObj.special.dict.big_atchpic];cgdb_big_pic.cont_id="SohuBottom2_f";self.insertImage(cgdb_big_pic)}else if(corespe.sflash()==1){var sohuFlash2=new sohuFlash(adObj[adObj.special.dict.big].file,"cgdb_flash",adObj[adObj.special.dict.big].width,adObj[adObj.special.dict.big].height,"7");sohuFlash2.addParam("quality","high");sohuFlash2.addParam("wmode","transparent");sohuFlash2.addVariable("clickthru",escape(adObj[adObj.special.dict.big].click));sohuFlash2.write("SohuBottom2_f")}}else if(adObj.resource.type=="image"){var cgdb_big_pic=adObj[adObj.special.dict.big];cgdb_big_pic.cont_id="SohuBottom2_f";self.insertImage(cgdb_big_pic)}var flash_click_cover=jQuery("<div></div>").attr('class','flash_click_cover');flash_click_cover.css({'position':'absolute','width':'100%','height':'100%','background-color':'red','opacity':0,'filter':'alpha(opacity=0)','cursor':'pointer'}).prependTo(jQuery("#SohuBottom2_f"));this.adObject.container=jQuery("#SohuBottom2");flash_click_cover.bind("click",function(event){self.adObject.cx=event.clientX;self.adObject.cy=event.clientY;stat.get("click",adObj);self.postAdplus(self.adObject)});isReplayed=true;self.addAdFlag(adObj,"SohuBottom2")},sohuad_buttom_s:function(){var adObj=this.adObject;var self=this;jQuery('#SohuBottomWrapper').show();if(adObj.resource.type=="flash"){if(corespe.sflash()==0){var cgdb_small_pic=adObj[adObj.special.dict.small_atchpic];cgdb_small_pic.cont_id="SohuBottom_f";self.insertImage(cgdb_small_pic)}else if(corespe.sflash()==1){var sohuFlash2=new sohuFlash(adObj[adObj.special.dict.small].file,"_SohuBottomAd_s",adObj[adObj.special.dict.small].width,adObj[adObj.special.dict.small].height,"7");sohuFlash2.addParam("quality","high");sohuFlash2.addParam("wmode","transparent");sohuFlash2.addVariable("clickthru",escape(adObj[adObj.special.dict.small].click));sohuFlash2.write("SohuBottom_f")}}else if(adObj.resource.type=="image"){var cgdb_small_pic=adObj[adObj.special.dict.small];cgdb_small_pic.cont_id="SohuBottom_f";self.insertImage(cgdb_small_pic)}jQuery('#SohuBottomWrapper2').hide();adObj.container=jQuery("#SohuBottom");this.addAdFlag(adObj,"SohuBottom");if(report_small<1&&!reported_small){this.report_pv(adObj);report_small++}},sohuad_buttom_c:function(){jQuery('#SohuBottomWrapper').hide();jQuery('#SohuBottomWrapper2').hide()},sohuad_buttom_n:function(){var adObj=this.adObject;var opt=this.options;var userAgent=navigator.userAgent.toLowerCase();var browserId=userAgent.match(/(firefox|chrome|safari|opera|msie|mozilla)/)[1];var browserVersion=(userAgent.match(new RegExp('.+(?:version)[\/: ]([\\d.]+)'))||userAgent.match(new RegExp('(?:'+browserId+')[\/: ]([\\d.]+)'))||[0,'0'])[1];var isIe6=(browserId+browserVersion=="msie6.0");var SohuBottomAdWrapper_css='';var SohuBottomAd_css='width:'+opt.width+'px;height:'+adObj[adObj.special.dict.small].height+'px;margin:0 auto;position:relative;';if(isIe6){SohuBottomAdWrapper_css="width:1180px;height:"+adObj[adObj.special.dict.small].height+"px;position:absolute;z-index:999;left:"+(winWidth-1180)/2+"px;top:"+((document.documentElement).clientHeight-adObj[adObj.special.dict.small].height)+"px"}else{SohuBottomAdWrapper_css="width:1180px;height:"+adObj[adObj.special.dict.small].height+"px;bottom:0;left:"+(winWidth-1180)/2+"px;position:fixed;z-index:999;"}var SohuBottomAdWrapper='<div id="SohuBottomWrapper" style="'+SohuBottomAdWrapper_css+'"><div id="SohuBottom" style="'+SohuBottomAd_css+'"><div id="SohuBottom_f"></div></div></div>';jQuery('body').append(jQuery(SohuBottomAdWrapper));var tmpwidth=opt.width-40;var control_list='<div id="hover_over" style="background:#fff;background-color: rgb(255, 255, 255);filter:alpha(opacity=1);-moz-opacity:0.01;opacity:0.01;width:'+tmpwidth+'px;height:'+adObj[adObj.special.dict.big].height+'px;position:absolute;top:0;left:0;cursor:pointer;cursor:hand;"></div><div id="bottom_close" style="width:39px;height:16px;position:absolute;bottom:0;cursor:pointer;right:43px;"><a><img src="http://images.sohu.com/bill/s2012/gates/all/close_h.png"></a></div><div id="bottom_replay" style="width:39px;height:16px;position:absolute;top:0;cursor:pointer;right:25px;"><a><img src="http://images.sohu.com/bill/s2012/gates/all/replay_h.png"></a></div>';jQuery('#SohuBottom').append(jQuery(control_list));var SohuBottomAdWrapper2_css='';var SohuBottomAd2_css='width:'+opt.width+'px;height:'+adObj[adObj.special.dict.big].height+'px;margin:0 auto;position:relative;';if(isIe6){SohuBottomAdWrapper2_css="width:1180px;height:"+adObj[adObj.special.dict.big].height+"px;position:absolute;z-index:999;left:"+(winWidth-1180)/2+"px;top:"+((document.documentElement).clientHeight-adObj[adObj.special.dict.big].height)+"px"}else{SohuBottomAdWrapper2_css="width:1180px;height:"+adObj[adObj.special.dict.big].height+"px;bottom:0;left:"+(winWidth-1180)/2+"px;position:fixed;z-index:999;"}var SohuBottomAdWrapper2='<div id="SohuBottomWrapper2" style="'+SohuBottomAdWrapper2_css+'"><div id="SohuBottom2" style="'+SohuBottomAd2_css+'"><div id="SohuBottom2_f"></div></div></div>';jQuery('body').append(jQuery(SohuBottomAdWrapper2));var control_list2='<div id="bottom_close2" style="width:39px;height:16px;position:absolute;top:0;cursor:pointer;right:40px;"><a><img src="http://images.sohu.com/bill/s2012/gates/all/close_h.png"></a></div>';jQuery('#SohuBottom2').append(jQuery(control_list2))},attach:function(){var self=this;var adObj=self.adObject;jQuery('#bottom_close').bind('click',function(){self.sohuad_buttom_c()});jQuery('#bottom_close2').bind('click',function(){clearTimeout(sohuad_bottom_time);self.sohuad_buttom_s()});jQuery('#bottom_replay').bind('click',function(){sohuad_bottom_replay=1;if(!isReplayed){self.report_pv(adObj);isReplayed=true}self.sohuad_buttom_b()});jQuery(window).scroll(function(){var userAgent=navigator.userAgent.toLowerCase();var browserId=userAgent.match(/(firefox|chrome|safari|opera|msie|mozilla)/)[1];var browserVersion=(userAgent.match(new RegExp('.+(?:version)[\/: ]([\\d.]+)'))||userAgent.match(new RegExp('(?:'+browserId+')[\/: ]([\\d.]+)'))||[0,'0'])[1];var isIe6=(browserId+browserVersion=="msie6.0");var a=jQuery(window).scrollTop();if(isIe6){jQuery('#SohuBottomWrapper').css({'top':jQuery(window).scrollTop()+((document.documentElement).clientHeight-adObj.resource.height)});jQuery('#SohuBottomWrapper2').css({'top':jQuery(window).scrollTop()+((document.documentElement).clientHeight-adObj.resource1.height)})}});jQuery(window).resize(function(){if(window.innerWidth)var winWidth_resize=document.body.clientWidth;else if((document.body)&&(document.body.clientWidth))var winWidth_resize=document.body.clientWidth;if(winWidth_resize>adObj.resource.width){jQuery("#SohuBottomWrapper2").css({"left":(winWidth_resize-self.options.width)/2});jQuery("#SohuBottomWrapper").css({"left":(winWidth_resize-self.options.width)/2});jQuery("#SohuBottomWrapper2").css({"width":adObj.resource.width});jQuery("#SohuBottomWrapper").css({"width":adObj.resource.width});jQuery("#SohuBottom2").css({"width":adObj.resource.width});jQuery("#SohuBottom2_f embed").css({"width":adObj.resource.width});jQuery("#SohuBottom2_f img").css({"width":adObj.resource.width});jQuery("#SohuBottom").css({"width":adObj.resource.width});jQuery("#SohuBottom_f embed").css({"width":adObj.resource.width});jQuery("#SohuBottom_f img").css({"width":adObj.resource.width})}else{jQuery("#SohuBottomWrapper2").css({"width":winWidth_resize,"left":""});jQuery("#SohuBottomWrapper").css({"width":winWidth_resize,"left":""});jQuery("#SohuBottom2").css({"width":winWidth_resize});jQuery("#SohuBottom2_f embed").css({"width":winWidth_resize});jQuery("#SohuBottom2_f img").css({"width":winWidth_resize});jQuery("#SohuBottom").css({"width":winWidth_resize});jQuery("#SohuBottom_f embed").css({"width":winWidth_resize});jQuery("#SohuBottom_f img").css({"width":winWidth_resize})}})},check:function(){var opt=this.options;var itemspaceid=this.adObject.itemspaceid;var timelimit=opt.timelimit;if(timelimit){var cookie_name='beans_visit';var cookie_visit=cookie(cookie_name)||"{}";cookie_visit=JSON.parse(cookie_visit);cookie_visit[itemspaceid]=cookie_visit[itemspaceid]||1;var ad_visit=cookie_visit[itemspaceid];cookie_visit[itemspaceid]++;cookie(cookie_name,JSON.stringify(cookie_visit),{"path":'/',"expires":1});if(ad_visit>timelimit){return true}else{return false}}else{return false}},addMonitorkey:function(){jQuery("<div id='"+this.adObject.monitorkey+"' style='display:none;'>").appendTo(jQuery("#"+this.adObject.cont_id))},report_pv:function(adObj){adObj.cx='';adObj.cy='';stat.get("av",adObj);stat.get("pv",adObj);stat.ad_plus_pv(adObj)},isChrome:function(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("chrome")>1},_mime:function(option,value){var mimeTypes=navigator.mimeTypes;for(var mt in mimeTypes){if(mimeTypes[mt][option]==value){return true}}return false},addAdFlag:function(adObj,id){if(id=="SohuBottom"){if(jQuery(".ad-flag-cgdb").length>0){return false}var adflag=$("<div id='ad-flag-cgdb' class='ad-flag-cgdb'></div>").css({"position":"absolute","bottom":"0px","height":"16px","color":"white","right":0,"opacity":"0.8","filter":"alpha(opacity=0.8)","background-color":"rgb(93, 89, 89)"}).appendTo($("#"+id));if(!!adObj.dsp_source&&this.getRealLength(adObj.dsp_source)<=4){jQuery("<p>"+adObj.dsp_source+"|广告"+"</p>").css({"padding":"0 0px"}).appendTo(jQuery("#ad-flag-cgdb"))}else{jQuery("<p>广告</p>").css({"padding":"0 0px"}).appendTo(jQuery("#ad-flag-cgdb"))}jQuery("#"+adObj.cont_id).bind("mouseover",function(){jQuery("#ad-flag-cgdb p").css({"color":"white"})});if(this.checkIE()){jQuery("#ad-flag-cgdb").css({"filter":"alpha(opacity=60)"})}jQuery('<a href="http://www.iac-i.org/privacy/" target="_blank" class="got-i-icon"></a>').appendTo($("#"+id))}else if(id=="SohuBottom2"){if(jQuery(".ad-flag-cgdb2").length>0){return false}var adflag2=$("<div id='ad-flag-cgdb2' class='ad-flag-cgdb2'></div>").css({"position":"absolute","bottom":"0px","height":"16px","color":"white","opacity":"0.8","right":0,"filter":"alpha(opacity=0.8)","background-color":"rgb(93, 89, 89)"}).appendTo($("#"+id));if(!!adObj.dsp_source&&this.getRealLength(adObj.dsp_source)<=4){jQuery("<p>"+adObj.dsp_source+"|广告"+"</p>").css({"padding":"0 0px"}).appendTo(jQuery("#ad-flag-cgdb2"))}else{jQuery("<p>广告</p>").css({"padding":"0 0px"}).appendTo(jQuery("#ad-flag-cgdb2"))}jQuery("#"+adObj.cont_id).bind("mouseover",function(){jQuery("#ad-flag-cgdb2 p").css({"color":"white"})});if(this.checkIE()){jQuery("#ad-flag-cgdb2").css({"filter":"alpha(opacity=60)"})}jQuery('<a href="http://www.iac-i.org/privacy/" target="_blank" class="got-i-icon"></a>').appendTo($("#"+id))}},checkIE:function(){var DEFAULT_VERSION="8.0";var ua=navigator.userAgent.toLowerCase();var isIE=ua.indexOf("msie")>-1;var safariVersion;if(isIE){safariVersion=ua.match(/msie ([\d.]+)/)[1];if(safariVersion<=DEFAULT_VERSION){return true}else{return false}}else{return false}},getImp:function(imp){if(typeof imp!=="undefined"&&imp!=""){for(var i=0;i<imp.length;i++){new Image().src=imp[i]+'?t='+new Date().getTime()}}},getRealLength:function(str){var length=str.length;var realLength=0;var temLength=0;for(var i=0;i<length;i++){charCode=str.charCodeAt(i);if(charCode>=0&&charCode<=128){temLength+=1}else{realLength+=1}if(temLength==2){realLength+=1;temLength=0}}if(temLength==0){return realLength}else{return realLength+0.5}}});return Cgdb});